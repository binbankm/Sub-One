# Sub-One 延迟测试功能说明

## 🎯 功能概述

Sub-One 延迟测试功能是一个专业的节点连接质量检测系统，支持多种协议的真实连接测试，为用户提供准确的延迟数据，帮助选择最优节点。

## ✨ 核心特性

### 1. 多协议支持
- **SS/SSR**: 支持Shadowsocks系列协议
- **VMess/VLESS**: 支持V2Ray核心协议
- **Trojan**: 支持Trojan协议
- **Hysteria/Hysteria2**: 支持Hysteria系列协议
- **TUIC**: 支持TUIC协议
- **AnyTLS**: 支持AnyTLS协议
- **SOCKS5**: 支持SOCKS5协议

### 2. 真实连接测试
- **多次测试**: 每个节点进行3次测试，取平均值提高准确性
- **多种连接方式**: 支持HTTPS、HTTP、fetch等多种连接测试
- **超时控制**: 智能超时设置，避免长时间等待
- **性能优化**: 使用performance.now()进行高精度时间测量

### 3. 智能并发控制
- **分批处理**: 将大量节点分批测试，避免资源耗尽
- **并发限制**: 控制同时测试的节点数量，平衡性能和准确性
- **进度显示**: 实时显示测试进度和状态

### 4. 结果管理
- **实时更新**: 测试结果实时显示在界面上
- **数据导出**: 支持CSV格式导出测试结果
- **智能排序**: 按延迟从低到高自动排序
- **统计信息**: 显示成功率、平均延迟等统计指标

## 🛠️ 技术实现

### 前端组件
1. **useLatencyTest.js**: 延迟测试的组合式函数
2. **Dashboard.vue**: 主界面集成延迟测试功能
3. **ManualNodeCard.vue**: 手动节点卡片显示延迟结果
4. **ManualNodeList.vue**: 手动节点列表显示延迟结果

### 测试流程
```
1. 解析节点URL → 提取主机和端口
2. 进行3次测试 → 每次尝试不同连接方式
3. 计算平均延迟 → 去除异常值
4. 记录结果 → 返回延迟数据
```

## 📱 使用方法

### 手动节点测试
1. 在手动节点管理页面
2. 点击"一键测试"按钮进行批量延迟测试
3. 等待测试完成，查看延迟结果
4. 可选择导出测试结果或清除结果

### 测试结果解读
- **绿色**: 延迟 < 100ms (优秀)
- **黄色**: 延迟 100-300ms (良好)  
- **橙色**: 延迟 300-1000ms (一般)
- **红色**: 延迟 > 1000ms (较差)

## 🔧 配置选项

### 测试参数
- **测试次数**: 每个节点测试3次
- **连接超时**: 每次测试3秒超时
- **并发控制**: 最多同时测试3个节点
- **批次延迟**: 批次间200ms延迟

### 安全设置
- **身份验证**: 需要管理员权限才能进行测试
- **请求限制**: 防止恶意请求和资源滥用
- **错误处理**: 完善的错误边界和异常处理

## 📊 性能优化

### 前端优化
- **响应式更新**: 使用Vue 3响应式系统
- **虚拟滚动**: 大量节点的高效渲染
- **懒加载**: 按需加载测试结果

### 测试优化
- **分批处理**: 避免同时发起过多请求
- **并发控制**: 平衡性能和准确性
- **资源管理**: 智能超时和错误处理

## 🚀 扩展功能

### 未来计划
1. **历史记录**: 保存测试历史，支持趋势分析
2. **自动测试**: 定时自动测试，监控节点质量
3. **告警系统**: 节点质量下降时自动告警
4. **API接口**: 提供外部API接口，支持第三方集成

### 自定义配置
1. **测试频率**: 可配置测试间隔和频率
2. **超时设置**: 可调整各种连接方式的超时时间
3. **协议支持**: 可扩展支持更多协议类型

## 🔍 故障排除

### 常见问题
1. **测试失败**: 检查网络连接和节点状态
2. **延迟异常**: 可能是网络波动或节点负载过高
3. **连接超时**: 调整超时设置或检查防火墙配置

### 调试信息
- 查看浏览器控制台的错误日志
- 检查网络请求的状态和响应
- 查看测试进度和结果统计

## 📝 更新日志

### v1.0.0 (当前版本)
- ✅ 基础延迟测试功能
- ✅ 多协议支持
- ✅ 批量测试
- ✅ 结果导出
- ✅ 智能排序
- ✅ 一键测试按钮
- ✅ 实时进度显示
- ✅ 结果统计展示

### 计划版本
- 🔄 历史记录功能
- 🔄 自动测试
- 🔄 告警系统
- 🔄 API接口

---

**Sub-One 延迟测试功能** - 让节点选择更智能，连接更稳定！ ⚡ 