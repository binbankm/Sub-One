/**
 * ==================== Sub-One Manager - Tailwind 主样式文件 ====================
 * 
 * 符合 Tailwind CSS 官方规范的样式组织
 * 使用 @layer 指令分层管理样式
 * 
 * ============================================================================
 */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ==================== Base Layer - 基础样式 ==================== */
@layer base {
  /* 全局字体和平滑 */
  html {
    @apply font-sans antialiased;
  }

  html, body {
    @apply m-0 p-0 h-full w-full overflow-x-hidden;
  }

  * {
    @apply box-border;
  }

  /* 自定义滚动条 */
  ::-webkit-scrollbar {
    @apply w-3 h-3;
  }

  ::-webkit-scrollbar-track {
    @apply bg-black/5 dark:bg-white/5 rounded-full;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-gradient-to-r from-primary-500 to-secondary-500 rounded-full border-3 border-transparent;
    background-clip: padding-box;
    @apply transition-all duration-300;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply from-secondary-500 to-primary-500;
  }

  /* 焦点样式管理 */
  input:focus:not(:focus-visible),
  textarea:focus:not(:focus-visible),
  select:focus:not(:focus-visible),
  button:focus:not(:focus-visible) {
    @apply outline-none;
  }

  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible,
  button:focus-visible {
    @apply outline-2 outline-primary-500 outline-offset-2 rounded-lg;
  }

  html.dark input:focus-visible,
  html.dark textarea:focus-visible,
  html.dark select:focus-visible,
  html.dark button:focus-visible {
    @apply outline-primary-400;
  }

  /* 重置 Tailwind 默认 focus ring */
  *:focus {
    --tw-ring-shadow: 0 0 #0000 !important;
  }
}

/* ==================== Components Layer - 组件样式 ==================== */
@layer components {
  
  /* ===== 按钮组件 ===== */
  
  .btn-modern {
    @apply px-4 py-2 rounded-xl font-semibold transition-all duration-300;
    @apply bg-gradient-to-r from-indigo-500 to-purple-600 text-white;
    @apply hover:shadow-lg hover:-translate-y-0.5 hover:from-indigo-600 hover:to-purple-700;
    @apply active:translate-y-0 active:scale-95;
    @apply disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 disabled:hover:scale-100;
  }

  .btn-modern-enhanced {
    @apply rounded-xl font-semibold transition-all duration-300 shadow-md;
    @apply flex items-center justify-center;
    @apply active:scale-95;
  }

  .btn-add {
    @apply bg-gradient-to-r from-blue-500 to-indigo-600 text-white;
    @apply hover:from-blue-600 hover:to-indigo-700 hover:shadow-lg hover:-translate-y-0.5;
  }

  .btn-update {
    @apply bg-gradient-to-r from-emerald-500 to-teal-600 text-white;
    @apply hover:from-emerald-600 hover:to-teal-700 hover:shadow-lg hover:-translate-y-0.5;
  }

  .btn-sort {
    @apply bg-gradient-to-r from-purple-500 to-pink-600 text-white;
    @apply hover:from-purple-600 hover:to-pink-700 hover:shadow-lg hover:-translate-y-0.5;
  }
  
  .btn-sort.sorting {
    @apply from-gray-500 to-gray-600;
  }

  .btn-import {
    @apply bg-gradient-to-r from-orange-500 to-amber-600 text-white;
    @apply hover:from-orange-600 hover:to-amber-700 hover:shadow-lg hover:-translate-y-0.5;
  }

  .btn-primary {
    @apply bg-gradient-to-r from-indigo-500 to-purple-600 text-white;
    @apply hover:from-indigo-600 hover:to-purple-700 hover:shadow-lg hover:-translate-y-0.5;
  }

  .btn-secondary {
    @apply bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200;
    @apply hover:bg-gray-200 dark:hover:bg-gray-600 hover:shadow-md;
  }

  .btn-danger {
    @apply bg-gradient-to-r from-red-500 to-pink-600 text-white;
    @apply hover:from-red-600 hover:to-pink-700 hover:shadow-lg hover:-translate-y-0.5;
  }

  .btn-cancel {
    @apply bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200;
    @apply hover:bg-gray-200 dark:hover:bg-gray-600 hover:shadow-md;
  }
  
  /* ===== 表单组件 ===== */
  
  .form-input {
    @apply w-full px-4 py-3 rounded-xl;
    @apply bg-white/90 dark:bg-gray-800/90;
    @apply border-2 border-gray-200 dark:border-gray-700;
    @apply text-gray-900 dark:text-gray-100;
    @apply placeholder-gray-400 dark:placeholder-gray-500;
    @apply focus:outline-none;
    @apply transition-all duration-300;
  }

  .input-modern {
    @apply w-full px-4 py-3 rounded-xl;
    @apply bg-white/90 dark:bg-gray-800/90;
    @apply border-2 border-gray-200 dark:border-gray-700;
    @apply text-gray-900 dark:text-gray-100;
    @apply placeholder-gray-500 dark:placeholder-gray-400;
    @apply focus:outline-none;
    @apply transition-all duration-300;
  }

  .input-modern-enhanced {
    @apply w-full px-4 py-3 rounded-xl;
    @apply bg-white/90 dark:bg-gray-800/90;
    @apply border-2 border-gray-200 dark:border-gray-700;
    @apply text-gray-900 dark:text-gray-100;
    @apply placeholder-gray-500 dark:placeholder-gray-400;
    @apply focus:outline-none;
    @apply transition-all duration-300;
    @apply shadow-sm hover:shadow-md;
  }

  .search-input-unified {
    @apply w-full pl-11 pr-4 py-2.5;
    @apply bg-white dark:bg-gray-800;
    @apply border border-gray-200 dark:border-gray-700;
    @apply rounded-xl;
    @apply text-sm text-gray-900 dark:text-gray-100;
    @apply placeholder-gray-400 dark:placeholder-gray-500;
    @apply focus:outline-none;
    @apply transition-all duration-300;
    @apply shadow-sm hover:shadow-md;
  }
  
  /* ===== 卡片组件 ===== */
  
  .card-glass {
    @apply bg-white/40 dark:bg-gray-800/30 backdrop-blur-xl border border-white/60 dark:border-white/10;
    @apply shadow-xl hover:shadow-2xl hover:bg-white/50 dark:hover:bg-gray-800/40;
    @apply transition-all duration-300;
  }
  
  /* ===== 加载和图标 ===== */
  
  .spinner {
    @apply w-8 h-8 border-4 border-gray-200 dark:border-gray-700;
    @apply border-t-indigo-500 rounded-full;
    @apply animate-spin;
  }
  
  .icon-btn {
    @apply p-2.5 rounded-xl transition-all duration-300;
    @apply text-gray-600 dark:text-gray-400;
    @apply hover:bg-white/50 dark:hover:bg-white/10;
    @apply hover:text-gray-900 dark:hover:text-gray-100;
    @apply hover:shadow-lg hover:-translate-y-0.5;
    @apply active:translate-y-0 active:scale-95;
  }

  /* ===== LoginView 特定样式 ===== */
  
  .form-input-login {
    @apply w-full px-4 pr-12 py-3.5 text-[0.9375rem] rounded-xl outline-none transition-all duration-300;
    @apply text-gray-900 dark:text-gray-50;
    @apply bg-gray-50 dark:bg-gray-800;
    @apply border-2 border-gray-300 dark:border-gray-700;
  }

  .form-input-login:focus {
    @apply border-primary-500 bg-white dark:bg-gray-800;
    box-shadow: 0 0 0 4px hsla(243, 75%, 59%, 0.1);
  }

  .form-input-login::placeholder {
    @apply text-gray-500 dark:text-gray-500;
  }

  .input-error {
    @apply border-red-600 !important;
    animation: shake 0.5s ease;
  }

  .login-button {
    @apply w-full px-4 py-4 text-base font-bold text-white rounded-2xl border-none cursor-pointer relative overflow-hidden transition-all duration-300;
    @apply disabled:opacity-60 disabled:cursor-not-allowed;
    background: linear-gradient(135deg, hsl(243, 75%, 59%) 0%, hsl(280, 72%, 54%) 100%);
    box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.4), 0 4px 6px -4px rgba(99, 102, 241, 0.3);
  }

  .login-button::before {
    content: '';
    @apply absolute inset-0 -translate-x-full transition-transform duration-600;
    background: linear-gradient(135deg, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%);
  }

  .login-button:hover::before {
    @apply translate-x-full;
  }

  .login-button:not(:disabled):hover {
    @apply -translate-y-0.5 scale-[1.02];
    box-shadow: 0 20px 25px -5px rgba(99, 102, 241, 0.5), 0 8px 10px -6px rgba(99, 102, 241, 0.4);
  }

  .login-button:not(:disabled):active {
    @apply translate-y-0 scale-[0.98];
  }

  /* 响应式 */
  @media (max-width: 640px) {
    .form-input-login {
      @apply px-3.5 pr-10 py-3 text-sm;
    }

    .login-button {
      @apply py-3.5 text-[0.9375rem];
    }
  }
}

/* ==================== Utilities Layer - 工具类 ==================== */
@layer utilities {
  /* 渐变文字 */
  .gradient-text {
    @apply bg-gradient-to-r from-primary-600 to-secondary-600;
    @apply bg-clip-text text-transparent;
  }

  .gradient-text-animated {
    background: linear-gradient(135deg, 
      hsl(280, 84%, 65%) 0%, 
      hsl(243, 75%, 59%) 33%, 
      hsl(189, 94%, 43%) 66%, 
      hsl(142, 71%, 45%) 100%
    );
    background-size: 200% 200%;
    animation: gradientShift 3s ease infinite;
    @apply bg-clip-text text-transparent;
  }

  /* 玻璃效果 */
  .glass {
    @apply bg-white dark:bg-gray-900;
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    @apply border border-white/20 dark:border-white/10;
  }

  /* 背景模糊工具 */
  .backdrop-blur-xs {
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
  }
  
  .backdrop-blur-sm {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
  
  .backdrop-blur-DEFAULT {
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }
  
  .backdrop-blur-lg {
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
  }
  
  .backdrop-blur-xl {
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
  }

  /* 隐藏滚动条 */
  .hide-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .hide-scrollbar::-webkit-scrollbar {
    @apply hidden;
  }

  /* 文字阴影 */
  .text-shadow {
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }
  
  .text-shadow-lg {
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  /* 多行截断 */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
    line-clamp: 1;
  }
  
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2;
  }
  
  .line-clamp-3 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    line-clamp: 3;
  }
}

/* ==================== 应用特定样式（不在 layer 中） ==================== */

/* 应用背景 - 动态渐变 */
body {
  background: linear-gradient(135deg, 
    hsl(243, 35%, 94%) 0%,
    hsl(280, 30%, 93%) 25%,
    hsl(189, 35%, 92%) 50%,
    hsl(280, 30%, 93%) 75%,
    hsl(243, 35%, 94%) 100%
  );
  background-size: 400% 400%;
  background-attachment: fixed;
  animation: gradientFlow 20s ease infinite;
  position: relative;
}

html.dark body {
  background: linear-gradient(135deg,
    hsl(243, 47%, 10%) 0%,
    hsl(280, 48%, 12%) 25%,
    hsl(189, 50%, 15%) 50%,
    hsl(280, 48%, 12%) 75%,
    hsl(243, 47%, 10%) 100%
  );
  background-size: 400% 400%;
  background-attachment: fixed;
  animation: gradientFlow 20s ease infinite;
}

/* 背景渐变流动动画 */
@keyframes gradientFlow {
  0%, 100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

/* 渐变位置移动动画 */
@keyframes gradientShift {
  0%, 100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

/* ==================== 暗黑模式过渡 ==================== */
* {
  @apply transition-colors duration-300;
}

.no-transition {
  transition: none !important;
}

/* ==================== 浏览器原生样式覆盖 ==================== */

/* 暗黑模式下的日期选择器图标 */
html.dark input[type="date"]::-webkit-calendar-picker-indicator,
html.dark input[type="datetime-local"]::-webkit-calendar-picker-indicator,
html.dark input[type="time"]::-webkit-calendar-picker-indicator {
  filter: invert(1);
  cursor: pointer;
  opacity: 0.8;
  transition: opacity 0.2s;
}

html.dark input[type="date"]::-webkit-calendar-picker-indicator:hover,
html.dark input[type="datetime-local"]::-webkit-calendar-picker-indicator:hover,
html.dark input[type="time"]::-webkit-calendar-picker-indicator:hover {
  opacity: 1;
}
